#!/bin/bash
# Run mini-ndn experiments

root_path="/home/mini-ndn/sdulal/mini-ndn"
path_to_conf_file="$root_path/current-testbed1.conf"
path_grap_script="/graph_script/graphing-scripts"

clean(){
   echo "reached clean"
   mn -c
   rm -rf /mnt/ramdisk/*
}

create_sym_link(){

    rm -rf hrls/* ?
    # this is transfer file to appropriate location
    #$1 = /ls/br/0,2,4/link-state
    #2 = /hr/br/0,2,3/
    ln -s  $root_path/$1/link-state hrls/ls
    ln -s $root_path/$2 hrls/hr

}
run_graphing_scrips(){

    # this will execute graphing scripts
    #sudo ln -s ../../../nlsr/0/link-state/ ls
    ./$path_grap_script/process/convergedata-bytime-new-ping.sh /home/mini-ndn/sdulal/mini-ndn/saurab/hr/asf/2
    ./$path_grap_script/plot/4-get-failure-stretch.sh ~/sdulal/mini-ndn/saurab/hr/asf/2
    sudo ./plot-failure-stretch.sh ~/sdulal/mini-ndn/saurab/hr/asf/2
    sudo ./4-get-failure-stretch.sh ~/sdulal/mini-ndn/saurab/hr/asf/4
    3sudo ./plot-failure-stretch.sh ~/sdulal/mini-ndn/saurab/hr/asf/4

#}
 # 1. HR with Best-Route Strategy
 # 2. HR with ASF and 2 next hops
 # 3. HR with ASF and 4 next hops
 # 4. HR with ASF and all next hops
echo "******************************** 1 "
clean
minindn --faces 0 --experiment=pingall --ctime=10 --no-cli $path_to_conf_file --work-dir=/mnt/ramdisk/ --result-dir=saurab/ls/br/0
echo "********************************* 2 "
clean
echo "********************************* 3"
minindn --faces 0 --routing hr --experiment=pingall --ctime=10 --no-cli $path_to_conf_file --work-dir=/mnt/ramdisk/ --result-dir=saurab/hr/br/0
echo "********************************** 4 "
clean

create_sym_link "saurab/ls/br/0" "saurab/hr/br/0/hr"
echo "********************************** 5 " 

#sudo minindn --faces 2 --experiment=pingall current-testbed.conf --work-dir=/mnt/ramdisk/ --result-dir=saurab/ls/br/2
#sudo minindn --faces 4 --experiment=pingall current-testbed.conf --work-dir=/mnt/ramdisk/ --result-dir=saurab/ls/br/4

#sudo minindn --faces 0 --routing hr --experiment=pingall current-testbed.conf --work-dir=/mnt/ramdisk/ --result-dir=saurab/hr/br/0 
#sudo minindn --faces 2 --routing hr --experiment=pingall current-testbed.conf --work-dir=/mnt/ramdisk/ --result-dir=saurab/hr/br/2
#sudo minindn --faces 4 --routing hr --experiment=pingall current-testbed.conf --work-dir=/mnt/ramdisk/ --result-dir=saurab/hr/br/4
#asf-exp
